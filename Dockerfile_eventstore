FROM eventstore/eventstore:latest

EXPOSE 1113 2113

ARG EVENTSTORE_CLUSTER_SIZE
ARG EVENTSTORE_RUN_PROJECTIONS 
ARG EVENTSTORE_START_STANDARD_PROJECTIONS 
ARG EVENTSTORE_EXT_TCP_PORT
ARG EVENTSTORE_HTTP_PORT 
ARG EVENTSTORE_INSECURE 
ARG EVENTSTORE_ENABLE_EXTERNAL_TCP 
ARG EVENTSTORE_ENABLE_ATOM_PUB_OVER_HTTP
ARG EVENTSTORE_MEM_DB

ENV EVENTSTORE_CLUSTER_SIZE=$EVENTSTORE_CLUSTER_SIZE
ENV EVENTSTORE_RUN_PROJECTIONS=$EVENTSTORE_RUN_PROJECTIONS
ENV EVENTSTORE_START_STANDARD_PROJECTIONS=$EVENTSTORE_START_STANDARD_PROJECTIONS
ENV EVENTSTORE_EXT_TCP_PORT=$EVENTSTORE_EXT_TCP_PORT
ENV EVENTSTORE_HTTP_PORT=$EVENTSTORE_HTTP_PORT
ENV EVENTSTORE_INSECURE=$EVENTSTORE_INSECURE
ENV EVENTSTORE_ENABLE_EXTERNAL_TCP=$EVENTSTORE_ENABLE_EXTERNAL_TCP
ENV EVENTSTORE_ENABLE_ATOM_PUB_OVER_HTTP=$EVENTSTORE_ENABLE_ATOM_PUB_OVER_HTTP
ENV EVENTSTORE_MEM_DB=$EVENTSTORE_MEM_DB

VOLUME /var/lib/eventstore
VOLUME /var/log/eventstore

WORKDIR /opt/eventstore

CMD ["eventstored", "--run-projections", "All"]
